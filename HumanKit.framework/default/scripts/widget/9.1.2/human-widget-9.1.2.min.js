!function(a,b){"use strict";!function(a,b){var c=a.HumanWidget={},d=c.dashNormalize=function(a){return/^[a-z]+([_[A-Z])[a-z]+/.test(a)?a.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/([a-zA-Z])_/g,"$1-").toLowerCase():a},e=c.params={},f=a.location.href.replace(/&amp;/g,"&"),g=/[?&]+([^=&]+)=([^&]*)/gi;f.replace(g,function(b,c,f){e[d(c)]=a.decodeURIComponent(f)});var h=function(b){var c={};if(b){c.full=a.document.referrer;var d=c.full.match(/:\/\/(.[^\/]+)/);c.domain=d&&d[1]?d[1]:c.full}else c.full=a.location.href,c.domain=a.document.domain||a.location.host;return c},i=function(a){var b=a.split(".").reverse(),c=/^(com|edu|gov|net|mil|org|nom|co|name|info|biz)$/i,d="";return d=b.length>=3&&c.test(b[1])?[b[2],b[1],b[0]].join("."):[b[1],b[0]].join(".")},j=a.top!==a,k=h(j);k.slDomain=i(k.domain),c.data={parentUrl:k,embedded:j,initialDisplay:{},support:null,params:c.params,content:{},developerKey:c.params.dk||null,userAnalyticId:c.params.uaid||null,appProductKey:c.params["app-productkey"]||null,appUserId:c.params["app-userid"]||null};var l=function(){var b=a.document.body,d=c.getDevice(a.navigator.userAgent),e=function(){b.style.position="absolute",b.style.top="0px",b.style.left="0px",b.style.right="0px",b.style.bottom="0px",b.style.height=a.innerHeight+"px"};"iPhone"!==d&&"iPad"!==d||!c.data.embedded||(a.addEventListener("resize",e,!0),e())},m=function(d){var e=d.EVENTS||{},f=e.onInit||function(){},g=e.onReady||function(){},h=e.onError||function(){},i=a.HumanScene;i.initEngine(function(){f(),i.content.set(function(e){c.extend(c.data.content,e),i.load(e,function(){i.startEngine(),g(e)},h),b.bootstrap(a.document,[d.NAME])},function(c){b.bootstrap(a.document,[d.NAME]),h(c)})})};c.getDevice=function(a){var b=["iPad","iPhone","iPod","Android"],c=a.match(new RegExp(b.join("|"),"i"));return c&&c[0]},c.serializeRequest=function(b){var c=[];for(var d in b)b.hasOwnProperty(d)&&c.push([a.encodeURIComponent(d),a.encodeURIComponent(b[d])].join("="));return c.join("&")},c.extend=function(){var a,b,c,d=Array.prototype.slice.call(arguments,0),e=d[0],f=d.slice(1);for(c=0;c<f.length;c++){a=f[c];for(b in a)a.hasOwnProperty(b)&&(e[b]=a[b])}return e},c.init=function(d){c.support=c.webgl.runTest(d.WEB_GL.device),c.data.support=c.support;var e=c.buildManifest(d.DEPENDENCIES,d.ENVIRONMENT.files);c.loadScripts(e.scripts,function(){if(c.support.pass){c.webgl.handleError(d.WEB_GL.error),Human.properties.set({assetDomain:d.ENVIRONMENT.assetDomain});var e=d.INIT_SEQUENCE||m;e(d)}else b.bootstrap(a.document,[d.NAME])}),c.loadStyles(e.styles)},l(),b.module("humanWidget",["ngTouch","ui.bootstrap","humanUI","humanWidget.pass","humanWidget.fail","humanWidget.analytics","humanWidget.backgroundColor","humanWidget.backgroundImage","humanWidget.templates"]).constant("EMBEDDED",j).config(["$uibTooltipProvider","BASE_CONFIG","CONFIG_ALIASES",function(a,c,d){if(b.extend(c,{help:!1,infoExpand:!1,menuExpand:!1}),b.extend(d,{keys:"help"}),Modernizr.touch){var e="tooltip-trigger",f=document.body.querySelectorAll("["+e+"]");b.element(f).attr(e,"none"),a.options({trigger:"none"})}}]).run(["WindowDimensions",function(a){a.init()}]).value("widgetParams",c.params).value("widgetData",c.data).provider("WindowDimensions",function(){var a={breakPoints:[480,768,991]},c=function(c,d,e,f){for(var g=b.element(d[0].body),h=a.breakPoints.concat(c.Infinity),i=[],j=0;j<h.length;j++)i.push(["lte",h[j]].join("-"));var k=null,l=function(a,b){k=a,g.removeClass(i.join(" ")),g.addClass(b),e.$broadcast("window.breakpoint",k),e.$apply()},m=function(){for(var a=0;a<h.length;a++)if(c.innerWidth<=h[a])return void(k!==h[a]&&l(h[a],i[a]))};return{init:function(){b.element(c).on("resize",m),f(m)}}};return c.$inject=["$window","$document","$rootScope","$timeout"],{$get:c,config:function(c){b.extend(a,c)}}}).filter("dashNormalize",function(){return c.dashNormalize}).filter("serializeRequest",function(){return c.serializeRequest}).controller("MainController",["$scope","widgetData",function(a,b){a.widgetData=b,a.widgetParams=b.params,a.embedded=b.embedded,a.pass=b.support.pass,a.result=b.support.fullResult,a.tour=!1,a.backgroundImage={},a.$on("human.moduleData",function(b,c){a.moduleData=c}),Human.events.on("modules.activate.finish",function(){a.tour=Human.timeline.activeRoot._chapters.length>1,a.$digest()}),a.$on("human.fallbackTour",function(b,c){a.fallbackTour=c,a.noFallbackTour=!c}),a.$on("backgroundImage.show",function(){a.backgroundImage.show=!0}),a.$on("backgroundImage.remove",function(){a.backgroundImage.remove=!0}),a.$on("backgroundImage.image",function(b,c){a.backgroundImage.load=!!c,a.backgroundImage.image=c||null})}]).directive("uiBd",["widgetParams",function(a){return{restrict:"A",priority:900,link:function(b,c){"false"===a["ui-bd"]&&c.addClass("ng-hide"),("no-link"===a["ui-bd"]||"false"===a["ui-bd.link"])&&(c.removeAttr("href"),c.removeAttr("target"),c.removeAttr("ga-event")),a["ui-bd.class"]&&c.addClass(a["ui-bd.class"])}}}]).directive("moduleError",["Human",function(a){return{restrict:"E",templateUrl:"templates/module_error.html",scope:!0,link:function(b){a.events.on("net.error",function(){b.show=!0,b.$apply()})}}}]).directive("bindTrustedHtml",function(){return{restrict:"A",link:function(a,b,c){a.$watch(c.bindTrustedHtml,function(a){b.html(a||"")})}}}).directive("broadcastUserInteraction",["$document","$rootScope","$timeout",function(a,c,d){var e="touchstart mousedown",f="touchmove mousemove",g="touchend touchcancel mouseup mouseleave",h=b.element(a[0].body);return{restrict:"A",link:function(i,j){var k,l=!1,m=!1,n=function(a){m=a,h[m?"addClass":"removeClass"]("user-interacting");var b="userInteracting.";b+=m?"start":"finish",c.$broadcast(b)},o=function(){l||(l=!0,d.cancel(k),k=void 0,k=d(function(){n(!0)},500)),j.css("cursor","default")},p=function(){l&&(l=!1,d.cancel(k),k=void 0,m&&(k=d(function(){n(!1)},500))),j.css("cursor","auto"),b.forEach(f.split(" "),function(b){a[0].removeEventListener(b,o,!0)}),b.forEach(g.split(" "),function(b){a[0].removeEventListener(b,p,!0)})};b.forEach(e.split(" "),function(c){j[0].addEventListener(c,function(){b.forEach(f.split(" "),function(b){a[0].addEventListener(b,o,!0)}),b.forEach(g.split(" "),function(b){a[0].addEventListener(b,p,!0)})},!0)})}}}]).directive("toggleElement",["$document","$timeout",function(a,c){return{restrict:"A",link:function(d,e,f){var g=a[0].querySelector(f.toggleElement),h=b.element(g),i=function(b){g.contains(b.target)||(e[0].contains(b.target)||h.addClass("ng-hide"),a[0].removeEventListener("touchstart",i,!0),a[0].removeEventListener("click",i,!0))},j=function(){c(function(){h.hasClass("ng-hide")?(a[0].removeEventListener("touchstart",i,!0),a[0].removeEventListener("click",i,!0)):(a[0].addEventListener("touchstart",i,!0),a[0].addEventListener("click",i,!0))})};e.on("click",function(){h.toggleClass("ng-hide"),f.hasOwnProperty("globalClose")&&j()})}}}]).directive("openFrameModal",["$window",function(a){var c=b.element(a);return{restrict:"A",link:function(a,b,d){b.on("click",function(){c.triggerHandler("frameModal.open",{src:d.openFrameModal,className:d.frameModalClass})})}}}]).directive("frameModal",["$window","$sce",function(a,c){var d=b.element(a),e=['<div id="frame-container" ng-class="setFrameClasses()">','  <button class="close" ng-click="closeFrame()">&times;</button>','  <iframe ng-if="src" ng-src="{{ src }}"></iframe>',"</div>"].join("\n");return{restrict:"E",scope:!0,template:e,link:function(e,f){var g,h=a.document.getElementById("frame-container"),i=b.element(h),j=function(){var b=h.getBoundingClientRect(),c=a.innerHeight-b.top-70;h.style["max-height"]=c+"px",g&&(g.style["max-height"]=c+"px")};e.closeFrame=function(){d.off("click",e.closeFrame),f.removeClass("open"),i.removeClass(),e.src=null,e.$applyAsync()},e.$watch("src",function(a){a?(g=h.querySelector("iframe"),j()):g=null}),d.on("frameModal.open",function(d,g){e.$applyAsync(function(){f.addClass("open"),g.className&&i.addClass(g.className),e.src=c.trustAsResourceUrl(g.src),b.element(a).one("click",e.closeFrame)})}),d.on("frameModal.close",e.closeFrame),d.on("resize",function(){e.src&&j()})}}}]).directive("windowBreakpoint",["$parse",function(a){return{restrict:"A",scope:!0,link:function(b,c,d){b.$on("window.breakpoint",function(c,e){b.breakpoint=e,a(d.windowBreakpoint)(b)})}}}])}(a,b),function(a){var c,d,e=a.HumanWidget,f=e.analytics={},g=e.data,h="/ws/developer/apps/access/key",i={app_productkey:g.appProductKey||"",app_userid:g.appUserId||"",app_apikey:g.developerKey||"",app_domain:g.parentUrl.full,app_activity:"",app_activity_status:"",app_activity_data:{},platform:"widget",widget_is_fullscreen:g.embedded?"False":"True"};for(c in g.params)g.params.hasOwnProperty(c)&&"dk"!==c&&(d=g.params[c],i.app_activity_data["url_param_"+c]=d);f.buildDeveloperActivity=function(a,b){a=a||{},b=b||{};var c=e.extend({},i,a),d=c.app_activity_data;return e.extend(d,b),c},f.postDeveloperActivity=function(b,c,d){var f=new XMLHttpRequest;c=c||function(){},d=d||function(){},f.onreadystatechange=function(){if(f.readyState===XMLHttpRequest.DONE){var b=a.JSON.parse(f.responseText),e={status:f.status,data:b};200===f.status?c(e):d(e)}},f.open("POST",h),f.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");var g=b.app_activity_data;b.app_activity_data=a.JSON.stringify(g),b=e.serializeRequest(b),f.send(b)};var j="/ws/user/analytics",k={analytic_id:"",analytic_type:"",analytic_description:"",analytic_data:{parent_analytic_identifier:g.userAnalyticId||"",referer_domain:g.parentUrl.full},analytic_platform:"widget",analytic_app_name:""};for(c in g.params)g.params.hasOwnProperty(c)&&"uaid"!==c&&(d=g.params[c],k.analytic_data["url_param_"+c]=d);f.buildAnalytic=function(a,b){a=a||{},b=b||{};var c=e.extend({},k,a),d=c.analytic_data;return e.extend(d,b),c},f.setAnalyticParent=function(a,b,c){var d=a.analytic_data;return d.parent_analytic_identifier=b,"undefined"!=typeof c&&(d.parent_is_owner=c),a},f.getAnalytic=function(b,c,d){var f=new XMLHttpRequest;c=c||function(){},d=d||function(){},f.onreadystatechange=function(){if(f.readyState===XMLHttpRequest.DONE){var b=a.JSON.parse(f.responseText),e={status:f.status,data:b};200===f.status?c(e):d(e)}};var g=e.serializeRequest({analytic_id:b});f.open("GET",[j,g].join("?")),f.send()},f.postAnalytic=function(b,c,d){var f=new XMLHttpRequest;c=c||function(){},d=d||function(){},f.onreadystatechange=function(){if(f.readyState===XMLHttpRequest.DONE){var b=a.JSON.parse(f.responseText),e={status:f.status,data:b};200===f.status?c(e):d(e)}},f.open("POST",j),f.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");var g=b.analytic_data;b.analytic_data=a.JSON.stringify(g),b=e.serializeRequest(b),f.send(b)},f.ga={};var l={content:"Content"},m={load:"Load",loadChapter:"Load Chapter"},n={contentName:0,chapterName:1,contentId:2,contentType:3,developerKey:4,appDomain:5,userId:6,platformType:7,appName:8,uaId:9},o=new Array(Object.keys(n).length),p=function(a,b){var c=[b+1,a||"unknown"].join(" "),d=l.content,e=m.loadChapter,g="";o[n.chapterName]=c,g=o[n.contentName]+":"+c,f.ga.sendEvent(d,e,g)},q=function(a){var b=a.split("/");return"[unspecified] "+b[b.length-1].replace(".json","")};f.ga.customTracker=null,f.ga.getEventDimensionsObject=function(){for(var a={},b=0;b<o.length;b++)a["dimension"+(b+1)]=o[b];return a},f.ga.init=function(a){var b,c,d=l.content,e=m.load,h="",i=g.content.bookmark?"bookmark":"module";"module"===i?(c=Human.modules.modules[g.content.id].displayName,b=g.content.id,c&&""!==c||(c=q(b))):(c=g.content.bookmark.title,b=g.params.be),h=c,o[n.contentName]=c,o[n.chapterName]=null,o[n.contentId]=b,o[n.contentType]=i,o[n.developerKey]=g.developerKey,Human.mobile&&Human.mobile.bundleid?(o[n.appDomain]=Human.mobile.bundleid,o[n.platformType]=Human.mobile.iOS?"iOS":"Android"):(o[n.appDomain]=g.parentUrl.domain,o[n.platformType]="Web Widget"),o[n.uaId]=g.userAnalyticId,a=a||{};for(var j in a)a.hasOwnProperty(j)&&(o[n[j]]=a[j]);f.ga.sendEvent(d,e,h),Human.events.on("timeline.chapters.activated",function(a){if(!g.content.bookmark){var b,c,d=a.newChapterIndex;Human.timeline.activeRoot?(b=Human.timeline.activeRoot._chapters,c=b[d].info.displayName):(b=Human.timeline.chapterList,c=b[d].displayName),b&&b.length>1&&p(c,d)}})};var r=function(a,b){var c;return c=b?[b,a].join("."):f.ga.customTracker?[f.ga.customTracker,a].join("."):a};f.ga.sendEvent=function(b,c,d,e){var g=f.ga.getEventDimensionsObject();a.ga(r("set",e),g),a.ga(r("send",e),{hitType:"event",eventCategory:b,eventAction:c,eventLabel:d})},b.module("humanWidget.analytics",[]).factory("GaAnalytics",function(){return f.ga}).directive("gaEvent",["$parse","$timeout","GaAnalytics",function(a,c,d){return{restrict:"A",scope:!1,link:function(e,f,g){var h,i=g.gaEventTracker,j=g.gaEventCategory||"UI",k=g.hasOwnProperty("gaUseCapture"),l=function(a){c(function(){d.sendEvent(j,a[0],a[1],i)})},m=function(c){var d=a(g.gaEvent)(e);b.isObject(d)&&!b.isArray(d)?b.forEach(d,function(a,b){h=f[0].querySelector(b),(h===c.target||h.contains(c.target))&&l(a)}):l(d)};f[0].removeEventListener("click",m,k),f[0].addEventListener("click",m,k)}}}])}(a),b.module("humanWidget.backgroundColor",[]).run(["$window",function(a){a.HumanBackground&&(a.HumanBackground.input.enableContentConfig(),a.HumanBackground.synchEngine())}]),b.module("humanWidget.backgroundImage",[]).constant("IMAGE_PARAMS",{large:{threshold:800,"default":{width:1200,height:800}},medium:{threshold:600,"default":{width:800,height:600}},small:{"default":{width:400,height:400}}}).constant("SCREENSHOT_SERVICE","/i").constant("BOOKMARK_SERVICE","/thumbnails/bookmarks").run(["widgetData","BackgroundImage",function(a,b){var c=a.support.pass;(c&&a.initialDisplay.image||!c)&&b.init()}]).factory("BackgroundImage",["$window","$timeout","$rootScope","Human","widgetParams",function(a,c,d,e,f){return{_store:{container:null,image:null},get:function(a){return this._store[a]},set:function(a,b){this._store[a]=b,d.$broadcast(["backgroundImage",a].join("."),b)},show:function(a){d.$broadcast("backgroundImage.show",a)},hide:function(){d.$broadcast("backgroundImage.hide")},remove:function(){d.$broadcast("backgroundImage.remove")},init:function(){var a=this,e=f.s||"male",g=f.m||f.a,h=f.be||f.b,i=f["load-image-src"]||f["image-src"],j=f["initial.image"];j&&"true"!==j&&(i=j),c(function(){var j;if(g||h){if(j={s:e},g)j.src=/\//.test(g)?g.replace(/\.json$/,""):["production",e+"Adult",g].join("/");else{var k=f.be?"eid":"id";j[k]=h}i||(i=b.copy(j))}d.$broadcast("backgroundImage.init",{src:i,base:j}),c(function(){i?a.show(i):a.remove()})})}}}]).directive("sizeBackgroundImage",["IMAGE_PARAMS","BackgroundImage",function(a,b){return{restrict:"A",scope:!0,link:function(c){var d,e,f=function(a){if(d||e)if(c.landscape=a.width>a.height,c.portrait=a.width<a.height,c.square=a.width===a.height,"initial"===c.widgetParams["image-size"]||"initial"===c.widgetParams["load-image-size"]){var b="large"===a.size&&(a.width>d[e]||a.height>d[e]);c.cover=!b}else c.cover=!0},g=function(c){if(c){var g=b.get("container"),h=a[g.size||"small"]["default"];d={width:c.width||h.width,height:c.height||h.height},e=d.width>=d.height?"width":"height",f(g)}else d=null,e=null};c.$watch("backgroundImage.image",g),c.$on("backgroundImage.container",function(a,b){f(b),c.$apply()})}}}]).directive("backgroundImage",["$document","$timeout","BackgroundImage","backgroundImageUrlFilter",function(a,b,c,d){return{restrict:"A",scope:!0,link:function(a,e){var f,g;a.show=!1;var h=function(b){var c,d,f;return b?(d=["progid:DXImageTransform","Microsoft",'AlphaImageLoader(src="'+b.src+'", sizingMethod="scale")'].join("."),c="url("+b.src+")"):c=d="none",f={"background-image":c,"-ms-filter":d,filter:d},a.hasContent=!!b,e.css(f),f},i=function(){h(null),c.set("image",{})},j=function(e){var i=$(new Image),j=!1,k=!1;a.loading=!0,i.load(function(){this.src.indexOf(f)>=0&&!k&&(k=!0,c.set("image",{css:h(this),src:this.src,width:this.width,height:this.height}),a.loading=!1,a.$apply())}),i.error(function(){this.src.indexOf(f)>=0&&(j=!0,h(null),c.set("image",null),a.show=!1,a.loading=!1,a.$apply())});var l=c.get("container").size;f=d(e,l),i[0].src=f,i[0].complete&&b(function(){k||i.trigger("load")}),g&&b.cancel(g),g=b(function(){k||j||i.trigger("load")},3e3)};a.$on("backgroundImage.show",function(b,c){j(c),a.show=!0}),a.$on("backgroundImage.hide",function(){i(),a.show=!1}),a.$on("backgroundImage.remove",function(){e.remove()})}}}]).directive("captureSize",["$window","IMAGE_PARAMS","BackgroundImage",function(a,c,d){return{restrict:"A",link:function(e,f){var g=b.element(a),h=function(){var a={width:f.outerWidth(),height:f.outerHeight()};for(var b in c)if(c.hasOwnProperty(b)){var e=c[b].threshold;if(a.width>=e||a.height>=e){a.size=b;break}}d.set("container",a)};e.$on("backgroundImage.init",h),e.$watch("backgroundImage.load",function(a){a&&(g.off("resize.backgroundImage"),g.on("resize.backgroundImage",h))}),e.$watch("backgroundImage.remove",function(a){a&&g.off("resize.backgroundImage")})}}}]).filter("backgroundImageUrl",["_moduleUrlFilter","_bookmarkUrlFilter","_customUrlFilter",function(a,b,c){return function(d,e){var f;if(d.s){var g=d.src?a:b;f=g(d,e)}else f=c(d);return f}}]).filter("_moduleUrl",["SCREENSHOT_SERVICE",function(a){return function(b){return a+"/"+b.src+".jpg"}}]).filter("_bookmarkUrl",["BOOKMARK_SERVICE",function(a){return function(b,c){var d=c?"&size="+c:"",e=b.eid?"eid":"id",f=["s="+b.s,e+"="+b[e]+d].join("&");return[a,f].join("?")}}]).filter("_customUrl",["$document","SCREENSHOT_SERVICE",function(a,b){var c=function(){var b=a[0],c=b.createElement("a");return c.href=b.referrer,c.hostname}();return function(a){var d;return"!"===a[0]?(d="//"+c,a=a.slice(1)):d=b,/^(http(s)?:)?\/\//.test(a)?a:[d,a].join("/")}}]),b.module("humanWidget.fail",[]).run(["$rootScope","Module","widgetData",function(a,b,c){var d=function(b){a.$broadcast("human.moduleData",b?b.data:null)};c.support.pass||b.get().then(d,d.bind(null,null))}]).factory("Module",["$http","widgetParams",function(a,b){return{get:function(){var c=b.s||"male",d=b.m||b.a,e=/\//.test(d)?d:"production/"+c+"Adult/"+d+".json";return a.get("/content/modules/"+e)}}}]).factory("cacheAssets",["backgroundImageUrlFilter","$timeout",function(a,c){return function(){var d=[],e=[],f=arguments[0],g=arguments[1];if(b.isObject(f)&&b.isDefined(g))for(var h=a(f),i=1;g>i;i++)d.push(h.replace(/(\.(\w{3}))$/,["_",".$2"].join(i)));else b.isArray(f)&&(d=f);b.forEach(d,function(a){if(b.isString(a)||b.isObject(a)&&"image"===a.type){var c=b.isString(a)?a:a.url;e.push((new Image).src=c)}}),c(function(){e=void 0})}}]).factory("FallbackVideo",["$rootScope",function(a){return{show:function(b){a.$broadcast("fallbackVideo.show",b)},hide:function(){a.$broadcast("fallbackVideo.hide")}}}]).directive("fallbackVideo",function(){return{restrict:"A",scope:!0,link:function(a,b){a.show=!1;var c,d=function(){c&&c.remove(),c=null};a.$on("fallbackVideo.show",function(e,f){d(),b.append("<iframe></iframe>"),c=b.children("iframe")[0],c.contentWindow.location.replace(f),a.show=!0}),a.$on("fallbackVideo.hide",function(){d(),a.show=!1})}}}).directive("defaultBackground",function(){return{restrict:"A",link:function(a,b){var c=function(a){return"boolean"==typeof a&&!a},d=function(){b.css({"background-image":'url("img/tiles_layer_50.jpg")',"background-size":"cover"})};a.$watch("backgroundImage.load",function(b){c(b)&&c(a.pass)&&d()}),a.$watch("pass",function(b){c(b)&&c(a.backgroundImage.load)&&d()})}}}).directive("fallbackTour",["$rootScope","BackgroundImage","FallbackVideo","cacheAssets",function(a,c,d,e){return{restrict:"E",scope:!0,template:"<fallback-tour-controls></fallback-tour-controls>",link:function(f){var g,h,i,j,k,l=function(a){a.hasOwnProperty("length")?(f.length=a.length,g&&e(g,a.length)):b.isArray(a.assets)&&(i=a.assets,f.length=i.length,e(i),f.showAsset(f.getAsset(0))),f.length>1&&(f.show=!0)};f.show=!1,f.getAsset=function(a){return k="image",i?(j=i[a],b.isObject(j)?(h=j.url,k=j.type||k):h=i[a]):(h=b.copy(g),a>0&&(h.src=[h.src,a].join("_"))),{src:h,type:k}},f.showAsset=function(a){"image"===a.type?(c.show(a.src),d.hide()):(d.show(a.src),c.hide()),f.curAsset=a},f.$on("human.moduleData",function(c,d){var e=d&&b.isObject(d.fallback);e&&l(d.fallback),a.$broadcast("human.fallbackTour",e)}),f.$on("backgroundImage.init",function(a,b){g=b.base})}}}]).directive("fallbackTourControls",function(){return{restrict:"E",template:'\r\n      <div class="arrow arrow-left"\r\n        ng-class="{ disabled: checkLimits(-1) === \'start\' }"\r\n        ng-click="step(-1)">\r\n      </div>\r\n      <div class="arrow arrow-right"\r\n        ng-class="{ disabled: checkLimits(1) === \'finish\' }"\r\n        ng-click="step(1)">\r\n      </div>\r\n    ',link:function(a){var b=0;a.checkLimits=function(c){return 0===b&&-1===c?"start":b===a.length-1&&1===c?"finish":!1},a.step=function(c){a.checkLimits(c)||(b+=c,a.showAsset(a.getAsset(b)))}}}}).directive("failModuleInfo",["$sce",function(a){return{restrict:"E",scope:!0,template:'\r\n      <button ng-show="!!description" ng-click="toggleInfo()"></button>\r\n      <h1>{{ displayName }}</h1>\r\n      <p ng-bind-html="description"></p>\r\n    ',link:function(b,c){b.toggleInfo=function(){c.toggleClass("open")},b.$watch("moduleData",function(c){c&&(b.displayName=c.displayName,b.description=a.trustAsHtml(c.description))})}}}]).directive("failMessage",function(){var a="play.google.com/store/apps/details?id=com.biodigitalhuman.humanAndroid",b="itunes.apple.com/us/app/biodigital-human-anatomy-health/id771825569";return{restrict:"E",scope:!0,templateUrl:"templates/fail_message.html",link:function(c){var d=function(d){if(d){var e=/android/i.test(d)?"android":"ios";c.deviceName="android"===e?"Android":d,c.deviceLink="android"===e?a:b,c.deviceLink="https://"+c.deviceLink,c.imgSrc="android"===e?"Android_App_Store_Get_Badge.png":"Download_on_the_App_Store_Badge_US-UK_135x40.png"}};c.$watch("result.device",d)}}}),function(a){var b=a.HumanWidget,c={min:!1,allowParams:!1,basePath:"scripts"},d=function(){for(var b,c,d=a.document.querySelectorAll("[ie-relink-css]"),e=0;e<d.length;e++)b=d[e],c=b.href,b.href="",b.href=c},e=function(a,b,c,d){return[a,b+"-"+c+d+".js"].join("/")},f=function(a,b,c,d){var e;return e=/engine/.test(b)?[a,"css","engine.css"].join("/"):[a,"css",b+"-"+c+d+".css"].join("/")};b.loadScripts=function(b,c){var d=b.length;if(0===d)return void a.setTimeout(c,0);for(var e=function(){0===--d&&c&&c()},f=function(b){var c=a.document.createElement("script");c.async=!1,c.src=b,c.onload=e,c.onerror=e,a.document.head.appendChild(c)},g=0;g<b.length;g++)f(b[g])},b.loadStyles=function(b,c){var e=a.document.getElementsByTagName("link-human-css")[0];if(e){for(var f=b.length,g=(function(){0===--f&&("ActiveXObject"in a&&d(),c&&c())}),h=function(b){var c=a.document.createElement("link");c.onload=g,c.onerror=g,c.href=b,c.rel="stylesheet",c.type="text/css",e.parentNode.insertBefore(c,e.nextSibling)},i=b.length-1;i>=0;i--)h(b[i]);e.parentNode.removeChild(e)}},b.buildManifest=function(a,d){var g,h,i,j,k,l={},m=b.extend({},a),n=b.extend({},c,d||{});n.allowParams&&(b.params["engine-version"]&&(m.humanEngine=b.params["engine-version"]),b.params["ui-version"]&&(m.humanUI=b.params["ui-version"]));var o=n.min?".min":"";for(g in m)m.hasOwnProperty(g)&&(h=m[g],i=g.replace("human","").toLowerCase(),j=g.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),k=[n.basePath,i,h].join("/"),l[i]={lib:k,files:{js:e(k,j,h,o),css:f(k,j,h,o)}});var p,q;if(n.humanScripts?p=n.humanScripts:(p=[],p.push(l.engine.files.js),p.push(l.ui.files.js)),b.params.plugins){for(var r=m.humanEngine,s=[n.basePath,"engine",r].join("/"),t=b.params.plugins.split(","),u=0;u<t.length;u++)t[u]=[s,"plugins",t[u],t[u]+".js"].join("/");p=p.concat(t)}return q=n.humanStyles?n.humanStyles:[l.engine.files.css,l.ui.files.css],{scripts:p,styles:q}}}(a),b.module("humanWidget.pass",[]).run(["widgetParams","widgetData","HumanSnapshot",function(a,c,d){var e,f,g=a.initial,h=a["initial.button"],i=a["initial.hand-hint"],j=a["initial.image"],k=a["load-image-src"]||a["image-src"],l=a["load-hint-hand"];l&&(e="fade"===l?"hand-hint-fade":"hand-hint"),(j||k)&&(e="default",f=!0),"true"===g&&(e="default"),"true"===h&&(e="default"),"true"===i&&(e="hand-hint"),c.initialDisplay.mode=e,c.initialDisplay.image=f,c.initialDisplay.enabled=b.isDefined(e),c.initialDisplay.initial=b.isDefined(e),c.support.pass&&(d.config({copyrightImagePath:"img/bhuman-logo-powered.png"}),d.loadCopyrightImage())}]).factory("ObjectTreeDisplay",["$document","$rootScope",function(a,c){for(var d,e=["human-object-tree","object-tree"],f=0;f<e.length&&!(d=a[0].querySelector(e[f]));f++);var g=b.element(d),h=!1,i=function(a){h="boolean"==typeof a?a:!h,g[h?"removeClass":"addClass"]("ng-hide")};return c.$on("window.breakpoint",function(a,b){480>=b&&i(!1)}),{setDisplay:i}}]).directive("humanLoadProgress",["$timeout",function(a){var c=["material","geometry","transform"],d=["tweens","morph"];return{restrict:"E",scope:!0,link:function(e){var f=[],g=!0;e.show=g,e.currentAssetType=null,Human.events.on("assets.load.start",function(){f.push(null)}),Human.events.on("assets.load.progress",function(a){if(!f[f.length-1]){var b=f.length-1;c.indexOf(a.assetType)>=0?f[b]="static":d.indexOf(a.assetType)>=0&&(f[b]="dynamic"),e.currentAssetType=f[b],e.show=g,(b>1||1===b&&"static"===f[b])&&(e.show=!1),e.$digest()}}),Human.events.on("assets.load.finish",function(){a(function(){e.show=!1})}),e.$watch("uiComponents.config.loadProgress",function(a){g=!b.isDefined(a)||a})}}}]).directive("initialDisplayClass",["$timeout","widgetData",function(a,b){return{restrict:"A",scope:!0,link:function(c,d){b.initialDisplay.mode&&d.addClass(b.initialDisplay.mode),"hand-hint-fade"===b.initialDisplay.mode&&(c.initialDisplay=b.initialDisplay,c.$watch("initialDisplay.enabled",function(c){c&&a(function(){b.initialDisplay.enabled=!1},5e3)}))}}}]).directive("initialDisplay",["widgetData",function(a){return{restrict:"A",link:function(b,c,d){c.on("click",function(){var c=d.initialDisplay;c="true"===c?!0:"false"===c?!1:!a.initialDisplay.enabled,a.initialDisplay.enabled=c,b.$apply()})}}}]).directive("mousewheelInfo",["$window","$timeout","Human","widgetData",function(a,c,d,e){var f=e.params["disable-scroll"],g=e.params["disable-scroll.alert"],h=e.params["disable-scroll.overlay"],i=g&&"false"!==g,j=h&&"false"!==h,k=f&&"false"!==f||i||j;return{restrict:"A",link:function(f,g){if(e.embedded&&k){d.input.mouseZoomCtrlKey=!0,j&&g.addClass("overlay");var h=!0,l=!1,m=function(){g[0].style.display="block",c(function(){g[0].style.opacity=1},0)},n=function(){g[0].style.opacity=0,c(function(){g[0].style.display="none",l=!1},1500)},o=a.document.getElementById("container");b.element(o).on("mousewheel",function(a){a.ctrlKey&&!h&&(h=!0,d.properties.set({"ui.mouseWheel.capture":!0})),!a.ctrlKey&&h&&(h=!1,d.properties.set({"ui.mouseWheel.capture":!1})),a.ctrlKey||l||(l=!0,(j||i)&&m(),c(n,3e3))})}}}}]).directive("globalInfo",["widgetData","Info",function(a,b){return{restrict:"A",scope:!1,link:function(c){var d,e=!1,f=!1,g=function(b){e=a.embedded?b:"false"!==a.params["ui-info"]&&"false"!==a.params["ui-panel"]&&"false"!==a.params["ui-all"]},h=function(a){d=b.state.current,f=a&&d&&a[d]};c.sceneInfo=b.state.info,c.$watchCollection("sceneInfo",function(a){h(a),c.infoEnabled=!(!f||!e)}),c.$watch("uiComponents.config.info",function(a){g(a),c.infoEnabled=!(!f||!e)}),c.$watch("uiComponents.config.infoExpand",function(a){c.infoExpanded=a})}}}]).directive("expandInfo",["$document",function(a){var c=b.element(a[0].querySelector("[human-info]"));return{restrict:"A",scope:!1,link:function(a,b){var d=function(b){c.hasClass("has-description")&&(b.stopPropagation(),a.uiComponents.config.infoExpand=!a.uiComponents.config.infoExpand,a.$apply())};b.on("mouseup",d)}}}]).directive("objectTreeDisplay",["ObjectTreeDisplay",function(a){return{restrict:"A",link:function(b,c,d){var e=d.objectTreeDisplay||"toggle";e="on"===e?!0:"off"===e?!1:void 0,c.on("click",function(){a.setDisplay(e)})}}}]).directive("timelineTouch",["$timeout","Human",function(a,b){return{restrict:"A",scope:!0,link:function(c){c.step=function(c){a(function(){b.timeline[1===c?"next":"prev"]()})}}}}]),function(a){var b=a.HumanWidget,c=b.activity={},d=b.analytics,e=b.data,f=["bookmark.nextChapter","bookmark.previousChapter","bookmark.set","camera.set","camera.zoom","scene.load","scene.selectObjects","timeline.nextChapter","timeline.pause","timeline.play","timeline.previousChapter","timeline.set","scene.picked","hotspots.picked"],g=[{name:"initial",value:"true"},{name:"initial.button",value:"true"},{name:"initial.hand-hint",value:"true"}],h=function(){var b=0,c=a.setInterval(function(){if(x)return void a.clearInterval(c);var d=Human.rpc.getLog(),e=d.slice(b);b=d.length;for(var g=0;g<e.length;g++){var h=e[g],i=-1!==f.indexOf(h.identifier);if(i){q({type:"api"});break}}},1e3)},i=function(b){var c=a.Human;if(401===b.status||403===b.status){var d=b.data||{},e=d.error||{},f=e.message||"";c.log.error(["Error initializing BioDigital Human API: "+f,"API functionality unavailable for this session.","Please ensure that the developer key parameter (dk)","in your iframe src is correct and registered to this","domain in your BioDigital developer account:","https://developer.biodigital.com/account/apps"].join("\n")),c.rpc.windowClientEnabled=!1}},j=function(){},k=function(b){if(e.embedded){var c=b.status,d=e.userAnalyticId,f={401:{error:"INVALID_CLIENTID",message:(d?"Uaid":"Client id")+" missing or invalid"},403:{error:"DOMAIN_UNREGISTERED",message:"Domain unregistered or not allowed"}},g=function(b,c){var d="/widget-auth-error.html",e=a.encodeURIComponent(c),f="error="+b+"&message="+e;return[d,f].join("?")},h=b.data||{},i=h.error||{},j=i.message||"";switch(c){case 401:case 403:f=f[c],j=j||f.message,a.location.replace(g(f.error,j))}}},l=function(a){if(a[0].intersectionRatio>=c.intersectThreshold){for(;u.length;)u.shift()();t.unobserve(s)}},m=function(){if(n()){for(;u.length;)u.shift()();a.removeEventListener("resize",m)}},n=function(){var a=s.getBoundingClientRect();return a.width>0&&a.height>0},o=function(b){"IntersectionObserver"in a?(t=new a.IntersectionObserver(l,{root:null,threshold:c.intersectThreshold}),u.push(b),t.observe(s)):n()?b():(u.push(b),a.addEventListener("resize",m))},p=function(){s=document.getElementById("container");var a;if(A)a=d.buildDeveloperActivity({app_activity:"view"}),d.postDeveloperActivity(a,j,k);else if(z)if(a=d.buildAnalytic({analytic_type:"view"}),w)d.postAnalytic(a,j,k);else{var b=d.postAnalytic.bind(null,a,j,k);v.push(b)}},q=function(b){if(!x){y||r();var c;if(A)c=d.buildDeveloperActivity({app_activity:"interactionf"},{interactionf_source:b.type}),d.postDeveloperActivity(c,j,k);else if(z)if(c=d.buildAnalytic({analytic_type:"interactionf"},{interactionf_source:b.type}),w)d.postAnalytic(c,j,k);else{var e=d.postAnalytic.bind(null,c,j,k);v.push(e)}a.document.removeEventListener("mousedown",q),a.document.removeEventListener("touchstart",F),a.document.removeEventListener("touchend",G),clearTimeout(B),x=!0}},r=function(){if(!y){var a;if(A)a=d.buildDeveloperActivity({app_activity:"interactionc"}),d.postDeveloperActivity(a,j,k);else if(z)if(a=d.buildAnalytic({analytic_type:"interactionc"}),w)d.postAnalytic(a,j,k);else{var b=d.postAnalytic.bind(null,a,j,k);v.push(b)}y=!0}};c.initContentInteractive=function(a){var b=!1,c=!1;a.events.on("assets.load.progress",function(a){"geometry"===a.assetType&&(b=!0)}),a.events.on("assets.load.finish",function(){b&&!c&&(c=!0,o(r))})},c.verifyAPI=function(b){b=b||{};var c=b.success||h,e=b.failure||i,f=d.buildDeveloperActivity({platform:"widgetapi",app_activity:"init"},{engine_version:a.Human.VERSION,api_version:a.Human.API_VERSION});d.postDeveloperActivity(f,c,e)},c.intersectThreshold=.75;var s,t=null,u=[],v=[],w=!1,x=!1,y=!1,z=!!e.userAnalyticId,A=!z;z&&d.getAnalytic(e.userAnalyticId,function(){for(w=!0;v.length;)v.shift()()},k);var B,C=0,D=0,E=200,F=function(a){var b=a.touches[0];

C=b.pageY,D=b.screenY,clearTimeout(B),B=setTimeout(function(){q(a)},E)},G=function(a){clearTimeout(B);var b=a.changedTouches[0],c=C-b.pageY,d=D-b.screenY,f=c!==d;f&&e.embedded||q(a)};a.addEventListener("DOMContentLoaded",p),a.document.addEventListener("mousedown",q);for(var H=!0,I=0;I<g.length;I++){var J=g[I];if(e.params[J.name]===J.value){H=!1;break}}H&&(a.document.addEventListener("touchstart",F),a.document.addEventListener("touchend",G))}(a),function(a,b){var c=a.HumanWidget,d=c.webgl={},e={device:{ios:!0,android:!0},error:{post:!0,log:!1,redirect:!1}},f=function(a,b){var d=function(d,e){return("true"===c.params["_"+d]||b[d])&&new RegExp("^"+e,"i").test(a.device)},e=d("ios","iP"),f=d("android","Android"),g=!a.device||e||f,h=a.html5&&a.webgl&&a.human&&g;return{pass:h,fullResult:a}},g=function(){return b.applicationcache&&b.canvas&&b.hashchange&&b.postmessage},h=function(){for(var b='webgl experimental-webgl webkit-3d moz-webgl "moz-glweb20',c=b.split(" "),d=a.document.createElement("canvas"),e=0;e<c.length;e++)try{if(d.getContext(c[e]))return!0}catch(f){}return!1};d.runTest=function(b){var d=c.extend({},e.device,b||{}),i=g(),j=i&&h(),k=i&&j,l={html5:i,webgl:j,human:k,device:c.getDevice(a.navigator.userAgent)};return f(l,d)},d.handleError=function(b){var d;d="true"===c.params["no-error-redirect"]?{post:!1,log:!0,redirect:!1}:c.extend({},e.error,b||{}),Human.events.once("error",function(b){d.log&&a.console.log(b);var e={log:b.log,stack:b.stack,webglInfo:b.webglInfo};if(d.post){var f=c.serializeRequest({category:b.name,log:JSON.stringify(e),message:b.message}),g="/ws/human-error",h="application/x-www-form-urlencoded; charset=UTF-8",i=new XMLHttpRequest;i.open("POST",g),i.setRequestHeader("Content-Type",h),i.send(f)}if(d.redirect){var j=["webgl-error.html?error=",b.name,"&message=["+b.type+"]",b.message].join("");a.location.replace(j)}})}}(a,Modernizr),b.module("humanWidget.templates",["templates/fail_message.html","templates/keypress_modal.html","templates/module_error.html"]),b.module("templates/fail_message.html",[]).run(["$templateCache",function(a){a.put("templates/fail_message.html",'<a ng-if="!!result.device" href="{{ deviceLink }}">\n  <p>Now freely available on {{ deviceName }}</p>\n  <img ng-src="{{ \'/img/\' + imgSrc }}">\n</a>\n\n<div ng-if="!result.device">\n  <div class="logo-image"></div>\n  <p class="error-generic">Sorry, it looks like your browser does not currently support the Human. Give us a try on Chrome or Firefox for your desktop.</p>\n  <div class="error-details" ng-show="!!result">\n      <h5><b>Details</b></h5>\n      <p id="support-webgl"><b>WebGL: {{ result.webgl }}</b><span></span></p>\n      <p id="support-html5"><b>HTML5: {{ result.html5 }}</b><span></span></p>\n      <p id="support-human"><b>Human: {{ result.human }}</b><span></span></p>\n  </div>\n</div>')}]),b.module("templates/keypress_modal.html",[]).run(["$templateCache",function(a){a.put("templates/keypress_modal.html",'<div class="content">\n  <div class="header">\n   <h1>Human Keypresses</h1>\n     <button>\n       <img\n         src="img/shim.gif"\n         alt="Close"\n         title="Close"\n         class="icon-close"\n         ng-click="in = false">\n     </button>\n  </div>\n  <iframe\n   id="keypress-frame"\n   class="modal-frame normal-scroll"\n   frameborder="0"\n   scrolling="auto">\n  </iframe>\n</div>')}]),b.module("templates/module_error.html",[]).run(["$templateCache",function(a){a.put("templates/module_error.html",'<div class="logo-image"></div>\n<p>Sorry, it looks like the module you\'re looking for was not found.</p>')}])}(window,angular);